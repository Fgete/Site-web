<!DOCTYPE html>
<html lang="fr">
	<head>
		<title>L A G</title>
		<meta charset="utf-8"/>
		<link rel="shortcut icon" type="image/x-icon" href="./images/logo.png"/>
		<link rel="stylesheet" type="text/css" href="./css/index.css">
	</head>
	<body onload="TilePosition(1), LoadingScreen()">

		<div id="loadingBack"></div>
		<div id="loadingScreen">
			<h2 id="loadingTitle">LOADING...</h2>
			<p class="loadingPara">
				Veuillez opérer quelques instants, le <span class="game">Site</span> va vous répondre...
			</p>
			<p class="loadingPara">
				Faites défiler les éléments avec la molette ou utilisez les flèches (↑ ↓) de votre clavier. Cliquez pour sélectionner et déselectionner un élément ou utilisez les flèches (← →) de votre clavier.
			</p>
			<p id="loadingClose" onclick="LoadingClose()">₪</p>
		</div>

		<script type="text/javascript"> // --- LOADING SCREEN ---
			
			function LoadingScreen(){
				loadingTitle = document.getElementById("loadingTitle");
				loadingClose = document.getElementById("loadingClose");
				loadingPara1 = document.getElementsByClassName("loadingPara")[0];

				loadingTitle.innerHTML = "LOADING... OK";
				loadingPara1.innerHTML = "Le <span class='game'>Site</span> est prêt à vous accueillir."
				loadingTitle.style.color = "#00FF00";
				loadingClose.style.opacity = "100%";
				loadingClose.style.pointerEvents = "auto";
				loadingClose.innerHTML = "►";
			}

			function LoadingClose(){
				loadingBack = document.getElementById("loadingBack");
				loadingScreen = document.getElementById("loadingScreen");

				loadingBack.parentNode.removeChild(loadingBack);
				loadingScreen.parentNode.removeChild(loadingScreen);
			}

		</script>

		<script type="text/javascript"> // --- INDEX NAVIGATION ---
			// VARIABLES
			var index = 1;
			var isSelected = 0;

			// POSITION
			var offsetX = 3; // vw
			var offsetY = 20; // vh
			var posX = 65; // vw
			var posY = 35; // vh
			var fade = 15; // %
			var blur = 5; // px
			var grayscale = 0;
			
			// DOCUMENT NODES
			root = document.documentElement;
			body = document.body;
			faders = document.getElementsByClassName("background");

			// Read wheel inputs
			document.addEventListener('wheel', function(wheel){
			    // Set index
			    if(wheel.deltaY > 0 && isSelected == 0) {
			        if (index < faders.length + 1)
			        	index++;
			    }
			    if(wheel.deltaY < 0 && isSelected == 0) {
			        if (index > 1)
			        	index--;
			    }

			    // Set background
			    for (var i = 0; i < faders.length; i++)
			    	faders[i].style.opacity = "0";
			    if (faders[index - 2] != null)
			    	faders[index - 2].style.opacity = "100%";

			    // Tiles position
			    tiles = document.getElementsByClassName("tile");

			    TilePosition();
			});

			// read keyboard inputs
			document.addEventListener('keydown', function(event){
			    // Set index
			    if(event.key == "ArrowDown" && isSelected == 0) {
			        if (index < faders.length + 1)
			        	index++;
			    }
			    if(event.key == "ArrowUp" && isSelected == 0) {
			        if (index > 1)
			        	index--;
			    }
			    if(event.key == "ArrowLeft" || event.key == "ArrowRight" || event.key == "Enter") {
			    	Selection();
			    }

			    // Set background
			    for (var i = 0; i < faders.length; i++)
			    	faders[i].style.opacity = "0";
			    if (faders[index - 2] != null)
			    	faders[index - 2].style.opacity = "100%";

			    // Tiles position
			    tiles = document.getElementsByClassName("tile");

			    TilePosition();
			});

			function TilePosition(){

				// Modify position in function of isSelected
				if (isSelected == 1){
					offsetX = 1;
					posX = 75;
					grayscale = .5;
				}else{
					offsetX = 3;
					posX = 65;
					grayscale = 0;
				}

				// Get node collection
				tiles = document.getElementsByClassName("tile");

				// Position collection
			    for (var i = 0; i < tiles.length; i++){
			    	tiles[i].style.right = ((index - (i + 1)) * (index - (i + 1)) * offsetX + posX) + "vw";
			    	tiles[i].style.top = ((index - (i + 1)) * offsetY + posY) + "vh";
			    	tiles[i].style.opacity = (100 - (index - (i + 1)) * (index - (i + 1)) * fade) + "%";
			    	tiles[i].style.zIndex = (10 - (index - (i + 1)) * (index - (i + 1)));
			    	var fBlur = "blur(" + ((index - (i + 1)) * (index - (i +1)) * blur) + "px)";
			    	var fGrayscale = "grayscale(" + (index - (i + 1)) * (index - (i + 1)) + grayscale + ")";
			    	tiles[i].style.filter = fBlur + " " + fGrayscale;

			    	// Set pointer events
			    	if ((i + 1) == index)
			    		tiles[i].style.pointerEvents = "auto";
			    	else
			    		tiles[i].style.pointerEvents = "none";
			    }
			}

			function Description(){

				description = document.getElementById("description");
				dTitle = description.getElementsByTagName("h1")[0];
				dLink = document.getElementById("seeMore");
				dPara = description.getElementsByTagName("p")[0];

				// Modify description content
				dTitle.innerHTML = tileCollection[index - 1][4];
				dLink.href = tileCollection[index - 1][2];
				dPara.innerHTML = tileDescription[index - 1];

				// Show the link if there is one
				if (tileCollection[index - 1][2] != "")
					dLink.innerHTML = "En savoir plus ►";
				else
					dLink.innerHTML = "";

				// Show description
				if (isSelected == 0){
					description.style.opacity = "0";
					description.style.marginLeft = "23vw";
				}else{
					description.style.opacity = "100%";
					description.style.marginLeft = "25vw";
				}

			}

			// Toggle selection and update tiles position
			function Selection(){
				if (isSelected == 0)
					isSelected = 1;
				else
					isSelected = 0;
				TilePosition();
				Description();
			}
		</script>

		<script type="text/javascript" src="./js/index - game.js"> // --- GAME --- </script>

		<div id="scroller">
			<script type="text/javascript"> // --- TILE BUILDING ---

				// [Title, Tile background, URL, Body background, Description title]

				var tileCollection = [
					["L A G", "./images/profil.jpg", "", "", "Qui suis-je?"],
					["VJing", "./images/articles/vjing.png", "./html/tiles/vjing.html", "./images/index/wallpaper_vjing.png", "Projet VJing"],
					["A.R.M.", "./images/articles/arm.png", "./html/tiles/arm.html", "./images/index/wallpaper_arm.png", "Projet de jeu d'horreur"]
				];

				var tileDescription = [
					["Bienvenue! Je m'appelle François GETE et je suis étudiant dans le jeu vidéo à <a href='https://ludus-academie.fr/' target='blank'>Ludus Académie</a>. Vous trouverez sur ce site mes différentes créations. Je vous invite donc à l'<span class='game' onclick='BeginGame()'>explorer</span>."],
					["Le 'projet VJing' est un projet audio-visuel ayant pour but de lier le son et l'image dans une performence live. La particularité de celui-ci, est l'utilisation du son au service de la 3D."],
					["Dans ce jeu, vous entrez dans la peau d'un employé de la ARM. Cette entreprise à pour but de répertorier et de classifier les objets considérés comme anormaux."]
				];

				for (var i = 0; i < tileCollection.length; i++){

					// Create tile
					var tile = document.createElement("div");
					tile.setAttribute("onclick", "Selection()");
					tile.setAttribute("id", "t" + (i + 1));
					tile.setAttribute("class", "tile");
					var title = document.createTextNode(tileCollection[i][0]);

					// Place tile
					tile.appendChild(title);
					document.getElementById("scroller").appendChild(tile);

					// Set tile background
					tile.style.backgroundImage = 'url("' + tileCollection[i][1] + '")';

					// Create associated background
					if (i > 0){
						var background = document.createElement("div");
						background.setAttribute("class", "background");
						background.setAttribute("style", "background-image: url('" + tileCollection[i][3] + "')");

						document.body.appendChild(background);
					}
				}

			</script>
		</div>

		<script type="text/javascript"> // --- DESCRIPTION BUILDING ---
			var description = document.createElement("div");
			description.setAttribute("id", "description");

			var descriptionTitle = document.createElement("h1");

			var descriptionPara = document.createElement("p");

			var descriptionLink = document.createElement("a");
			descriptionLink.setAttribute("id", "seeMore");

			description.appendChild(descriptionTitle);
			description.appendChild(descriptionPara);
			description.appendChild(descriptionLink);

			body.appendChild(description);
		</script>
	</body>
</html>